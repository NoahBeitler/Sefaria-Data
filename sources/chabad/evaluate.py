from sources.functions import *
from linking_utilities.parallel_matcher import *
from linking_utilities.weighted_levenshtein import WeightedLevenshtein



def get_score(words_a, words_b):
    normalizingFactor = 100
    smoothingFactor = 1
    ImaginaryContenderPerWord = 22
    str_a = u" ".join(words_a)
    str_b = u" ".join(words_b)
    dist = WeightedLevenshtein().calculate(str_a, str_b, normalize=False)
    score = 1.0 * (dist + smoothingFactor) / (len(str_a) + smoothingFactor) * normalizingFactor

    dumb_score = (ImaginaryContenderPerWord * len(words_a)) - score
    return dumb_score

PM_pairs = []
def find_dh(refs):
    global PM_pairs
    pm = ParallelMatcher(tokenizer=lambda x: bleach.clean(x, strip=True, tags=[]).split(),
                        min_words_in_match=4,
                        ngram_size=3,
                        only_match_first=True,
                        all_to_all=False,
                        min_distance_between_matches=0,
                        verbose=False,
                        calculate_score=get_score,
                        max_words_between=2,
                        dh_extract_method=lambda x: bleach.clean(x, strip=True, tags=[]))
    x = pm.match([r.normal() for r in refs], return_obj=True)
    PM_pairs += [(i.a.ref.normal(), i.b.ref.normal()) for i in x if i.score > 0]

def dher(dh):
    new_dh = dh.split("...")[0].split('כו׳')[0].strip()
    return new_dh

dh_pairs = []
def dh_and_pm():
    with open('results.csv', 'r') as f:
        reader = csv.reader(f)
        for r, row in tqdm(enumerate(reader)):
            if len(row) == 4:
                hasidic_ref, zohar_refs, dh, citation = row
                if len(dh) > 0:
                    results = match_ref(TextChunk(Ref(zohar_refs), lang='he', vtitle='Sulam Edition, Jerusalem 1945'), [dher(dh)], lambda x: x.split())
                    if None in results['matches']:
                        zohar_refs = Ref(zohar_refs).all_segment_refs()
                        find_dh([Ref(hasidic_ref)]+zohar_refs)
                    else:
                        dh_pairs.append((results['matches'][0].normal(), hasidic_ref))

dh_pairs = [('Zohar, Pekudei 29:283', 'Likkutei Torah, Pekudei 2:32'), ('Zohar, Vayechi 73:759', 'Likkutei Torah, Vayikra 1:19'), ('Zohar, Vayera 6:137', 'Likkutei Torah, Vayikra 1:19'), ('Zohar, Vayikra 1:8', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 52:359', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Pinchas 12:77', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 12:77', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Bereshit 1:1', 'Likkutei Torah, Tzav 7:24'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayigash 1:1', 'Likkutei Torah, Tazria 6:2'), ('Zohar, Bo 4:83', 'Likkutei Torah, Tazria 6:30'), ('Zohar, Korach 1:3', 'Likkutei Torah, Metzora 5'), ('Zohar, Vayikra 65:442', 'Likkutei Torah, Achrei Mot 4:16'), ('Zohar, Beshalach 21:311', 'Likkutei Torah, Emor 2:40'), ('Zohar, Balak 6:63', 'Likkutei Torah, Emor 3:17'), ('Zohar, Balak 6:61', 'Likkutei Torah, Emor 4:12'), ('Zohar, Bereshit 1:2', 'Likkutei Torah, Behar 3:3'), ('Zohar, Bereshit 83:234', 'Likkutei Torah, Behar 3:10'), ('Zohar, Terumah 96:921', 'Likkutei Torah, Bechukotai 3:8'), ('Zohar, Korach 8:39', 'Likkutei Torah, Bamidbar 10:12'), ('Zohar, Yitro 27:464', 'Likkutei Torah, Bamidbar 13:21'), ('Zohar, Balak 6:109', 'Likkutei Torah, Bamidbar 15:12'), ('Zohar, Yitro 35:566', 'Likkutei Torah, Bamidbar 15:10'), ('Zohar, Vayakhel 34:431', 'Likkutei Torah, Bamidbar 19:20'), ('Zohar, Nasso 4:48', 'Likkutei Torah, Nasso 5:13'), ('Zohar, Miketz 1:1', 'Likkutei Torah, Nasso 4:2'), ('Zohar, Vayigash 6:53', 'Likkutei Torah, Nasso 6:4'), ('Zohar, Bereshit 79:205', "Likkutei Torah, Beha'alotcha 7:6"), ('Zohar, Noach 1:1', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Terumah 74:737', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 34:400', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Emor 32:154', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 32:154', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Vayishlach 26:250', 'Likkutei Torah, Chukat 1:15'), ('Zohar, Bereshit 1:1', 'Likkutei Torah, Chukat 2:35'), ('Zohar, Mishpatim 3:167', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:167', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Chukat 4:23', 'Likkutei Torah, Chukat 4:3'), ('Zohar, Vayechi 71:730', 'Likkutei Torah, Chukat 10:39'), ('Zohar, Vayakhel 26:377', 'Likkutei Torah, Chukat 10:48'), ('Zohar, Mishpatim 3:210', 'Likkutei Torah, Balak 1:28'), ('Zohar, Vayishlach 15:165', 'Likkutei Torah, Balak 3:37'), ('Zohar, Bereshit 8:75', 'Likkutei Torah, Pinchas 4:1'), ('Zohar, Achrei Mot 50:299', 'Likkutei Torah, Matot 3:6'), ('Zohar, Bereshit 83:222', 'Likkutei Torah, Matot 5:3'), ('Zohar, Beshalach 11:134', 'Likkutei Torah, Masei 3:21'), ('Zohar, Beshalach 11:134', 'Likkutei Torah, Masei 3:21'), ('Zohar, Vayikra 1:5', 'Likkutei Torah, Masei 5:13'), ('Zohar, Balak 19:252', 'Likkutei Torah, Vaetchanan 5:12'), ('Zohar, Korach 8:38', 'Likkutei Torah, Vaetchanan 6:28'), ('Zohar, Korach 12:54', 'Likkutei Torah, Vaetchanan 6:28'), ('Zohar, Vayechi 72:751', 'Likkutei Torah, Eikev 2:21'), ('Zohar, Vayechi 72:751', 'Likkutei Torah, Eikev 2:29'), ('Zohar, Tazria 2:8', 'Likkutei Torah, Eikev 2:25'), ('Zohar, Terumah 76:745', "Likkutei Torah, Re'eh 2:14"), ('Zohar, Terumah 96:918', 'Likkutei Torah, Nitzavim 1:16'), ('Zohar, Achrei Mot 47:288', 'Likkutei Torah, Nitzavim 5:12'), ('Zohar, Yitro 20:338', 'Likkutei Torah, Nitzavim 7:29'), ('Zohar, Vayechi 72:750', 'Likkutei Torah, Rosh Hashanah 4:4'), ('Zohar, Tzav 20:137', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Tzav 20:137', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Shemot 44:339', 'Likkutei Torah, Rosh Hashanah 4:11'), ('Zohar, Tazria 3:11', 'Likkutei Torah, Yom Kippur 2:4'), ('Zohar, Pinchas 124:867', 'Likkutei Torah, Yom Kippur 2:8'), ('Zohar, Pinchas 124:867', 'Likkutei Torah, Yom Kippur 2:39'), ('Zohar, Bereshit 70:139', 'Likkutei Torah, Yom Kippur 2:55'), ('Zohar, Emor 42:260', "Likkutei Torah, Ha'Azinu 3:35"), ('Zohar, Noach 1:4', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Noach 1:14-2:15', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Balak 47:507', 'Likkutei Torah, Sukkot 1:15'), ('Zohar, Beshalach 27:362', 'Likkutei Torah, Sukkot 3:15'), ('Zohar, Vayechi 73:759', 'Likkutei Torah, Shemini Atzeret 4:11'), ('Zohar, Shmini 9:84', 'Likkutei Torah, Shemini Atzeret 5:7'), ('Zohar, Pekudei 14:88', 'Likkutei Torah, Shemini Atzeret 7:9'), ('Zohar, Vayechi 27:221', 'Likkutei Torah, Shemini Atzeret 7:19'), ('Zohar, Emor 45:289', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 25:124', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Achrei Mot 46:282', 'Likkutei Torah, Shir HaShirim 1:2'), ('Zohar, Terumah 9:62', 'Likkutei Torah, Shir HaShirim 5:20'), ('Zohar, Kedoshim 20:131', 'Likkutei Torah, Shir HaShirim 8:51'), ('Zohar, Balak 33:354', 'Likkutei Torah, Shir HaShirim 16:11'), ('Zohar, Vayigash 10:104', 'Likkutei Torah, Shir HaShirim 19:38'), ('Zohar, Balak 6:95', 'Likkutei Torah, Shir HaShirim 29:4'), ('Zohar, Bereshit 9:106', 'Likkutei Torah, Shir HaShirim 31:1'), ('Zohar, Beshalach 13:176', 'Likkutei Torah, Shir HaShirim 29:27'), ('Zohar, Pekudei 46:505', 'Likkutei Torah, Shir HaShirim 34:9'), ('Zohar, Vayigash 2:22', 'Torah Ohr, Vayigash 1:11')]
pm_pairs = [('Zohar, Pekudei 4:22', 'Likkutei Torah, Pekudei 2:32'), ('Zohar, Balak 45:479', 'Likkutei Torah, Vayikra 1:1'), ('Zohar, Vayikra 2:26', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 2:28', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 2:31', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 3:32', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 3:33', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 1:7', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 1:8', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 2:28', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 1:8', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 1:7', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 1:8', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 3:32', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Vayikra 3:33', 'Likkutei Torah, Vayikra 1:5'), ('Zohar, Pinchas 88:596', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 105:711', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 108:753', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 12:78', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 88:596', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 105:711', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 108:753', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Pinchas 12:78', 'Likkutei Torah, Vayikra 3:5'), ('Zohar, Vayetzei 23:225', 'Likkutei Torah, Tzav 7:14'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:232', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:232', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:220', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Vayetzei 23:232', 'Likkutei Torah, Tzav 7:30'), ('Zohar, Bereshit 19:218', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 19:218', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 19:218', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 39:376', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 87:274', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 8:84', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 27:283', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 16:183', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 13:150', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 15:175', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 19:216', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 98:403', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 98:400', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 64:65', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 61:52', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 7:68', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 50:5', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 82:219', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 2:7', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 39:376', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 87:274', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 64:65', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 61:52', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 50:5', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Bereshit 82:219', 'Likkutei Torah, Tzav 7:36'), ('Zohar, Terumah 97:923', 'Likkutei Torah, Tazria 6:1'), ('Zohar, Vayakhel 25:352', 'Likkutei Torah, Tazria 6:5'), ('Zohar, Bereshit 16:183', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 94:365', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 75:177', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 99:419', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 18:205', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 94:365', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Bereshit 75:177', 'Likkutei Torah, Tazria 6:4'), ('Zohar, Vayikra 27:200', 'Likkutei Torah, Tazria 6:32'), ('Zohar, Korach 4:18', 'Likkutei Torah, Metzora 5'), ('Zohar, Korach 7:32', 'Likkutei Torah, Metzora 5'), ('Zohar, Korach 1:3', 'Likkutei Torah, Metzora 5'), ('Zohar, Korach 2:11', 'Likkutei Torah, Metzora 5'), ('Zohar, Terumah 85:821', 'Likkutei Torah, Achrei Mot 3:9'), ('Zohar, Terumah 85:822', 'Likkutei Torah, Achrei Mot 3:9'), ('Zohar, Emor 39:212', 'Likkutei Torah, Achrei Mot 4:16'), ('Zohar, Bereshit 17:186', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 44:447', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 58:33', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 70:148', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 55:22', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 44:447', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 58:33', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 70:148', 'Likkutei Torah, Emor 6:27'), ('Zohar, Bereshit 55:22', 'Likkutei Torah, Emor 6:27'), ('Zohar, Behar 1:1', 'Likkutei Torah, Behar 1:24'), ('Zohar, Bereshit 83:234', 'Likkutei Torah, Behar 2:1'), ('Zohar, Korach 4:18', 'Likkutei Torah, Bamidbar 10:12'), ('Zohar, Yitro 27:464', 'Likkutei Torah, Bamidbar 13:21'), ('Zohar, Yitro 27:464', 'Likkutei Torah, Bamidbar 13:21'), ('Zohar, Yitro 27:464', 'Likkutei Torah, Bamidbar 13:21'), ('Zohar, Yitro 35:565', 'Likkutei Torah, Bamidbar 15:10'), ('Zohar, Yitro 35:566', 'Likkutei Torah, Bamidbar 15:10'), ('Zohar, Yitro 35:566', 'Likkutei Torah, Bamidbar 15:10'), ('Zohar, Yitro 35:566', 'Likkutei Torah, Bamidbar 15:10'), ('Zohar, Bamidbar 1:3', 'Likkutei Torah, Bamidbar 17:16'), ('Zohar, Bamidbar 1:1', 'Likkutei Torah, Bamidbar 17:16'), ('Zohar, Miketz 1:1', 'Likkutei Torah, Nasso 4:2'), ('Zohar, Miketz 1:1', 'Likkutei Torah, Nasso 4:2'), ('Zohar, Vayigash 5:49', 'Likkutei Torah, Nasso 6:4'), ('Zohar, Vayigash 6:53', 'Likkutei Torah, Nasso 6:4'), ('Zohar, Bamidbar 1:18', 'Likkutei Torah, Nasso 7:11'), ('Zohar, Emor 42:260', "Likkutei Torah, Beha'alotcha 1:9"), ('Zohar, Balak 8:150', "Likkutei Torah, Beha'alotcha 3:10"), ('Zohar, Bereshit 79:205', "Likkutei Torah, Beha'alotcha 7:6"), ('Zohar, Noach 7:39', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 7:45', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 9:56', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 9:56', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 25:192', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 20:155', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 10:63', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 1:3', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 5:32', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 13:87', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 27:208', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 36:295', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 7:39', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 7:45', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 9:56', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 9:56', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 10:63', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Noach 5:32', "Likkutei Torah, Sh'lach 7:3"), ('Zohar, Beshalach 20:302', "Likkutei Torah, Sh'lach 14:16"), ('Zohar, Vayetzei 32:310', "Likkutei Torah, Sh'lach 17:14"), ('Zohar, Terumah 62:648', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 31:341', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 47:525', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 74:737', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 31:341', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Terumah 47:525', "Likkutei Torah, Sh'lach 16:20"), ('Zohar, Emor 5:16', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 32:154', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 11:36', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 25:127', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:233', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 13:46', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:235', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 26:129', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:242', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 5:16', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 32:154', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 11:36', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 25:127', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:233', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 13:46', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:235', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 26:129', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Emor 40:242', "Likkutei Torah, Sh'lach 17:1"), ('Zohar, Korach 4:15', 'Likkutei Torah, Korach 1:32'), ('Zohar, Chayei Sara 1:7', 'Likkutei Torah, Korach 1:30'), ('Zohar, Vayishlach 26:250', 'Likkutei Torah, Chukat 1:15'), ('Zohar, Mishpatim 22:524', 'Likkutei Torah, Chukat 1:15'), ('Zohar, Mishpatim 22:526', 'Likkutei Torah, Chukat 1:15'), ('Zohar, Metzora 4:17', 'Likkutei Torah, Chukat 2:11'), ('Zohar, Metzora 4:17', 'Likkutei Torah, Chukat 2:11'), ('Zohar, Bereshit 1:1', 'Likkutei Torah, Chukat 2:35'), ('Zohar, Metzora 4:18', 'Likkutei Torah, Chukat 3:11'), ('Zohar, Pinchas 9:40', 'Likkutei Torah, Chukat 3:11'), ('Zohar, Terumah 96:920', 'Likkutei Torah, Chukat 6:1'), ('Zohar, Terumah 97:923', 'Likkutei Torah, Chukat 6:1'), ('Zohar, Mishpatim 28:565', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:269', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:270', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:206', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:99', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:167', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:267', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 24:546', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 24:546', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 24:547', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 24:547', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 24:547', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 28:565', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:36', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:281', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:252', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:269', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:270', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:206', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:99', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:167', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:267', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:36', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:281', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Mishpatim 3:252', 'Likkutei Torah, Chukat 3:10'), ('Zohar, Chukat 4:23', 'Likkutei Torah, Chukat 4:3'), ('Zohar, Bereshit 101:426', 'Likkutei Torah, Chukat 7:3'), ('Zohar, Vayechi 71:730', 'Likkutei Torah, Chukat 10:39'), ('Zohar, Korach 7:28', 'Likkutei Torah, Chukat 11:8'), ('Zohar, Mishpatim 3:210', 'Likkutei Torah, Balak 1:28'), ('Zohar, Mishpatim 3:210', 'Likkutei Torah, Balak 1:28'), ('Zohar, Mishpatim 3:211', 'Likkutei Torah, Balak 1:28'), ('Zohar, Mishpatim 3:210', 'Likkutei Torah, Balak 1:28'), ('Zohar, Mishpatim 3:210', 'Likkutei Torah, Balak 1:28'), ('Zohar, Balak 45:456', 'Likkutei Torah, Balak 1:28'), ('Zohar, Vayishlach 15:165', 'Likkutei Torah, Balak 3:37'), ('Zohar, Vayishlach 16:167', 'Likkutei Torah, Balak 3:37'), ('Zohar, Vayishlach 16:167', 'Likkutei Torah, Balak 3:37'), ('Zohar, Behar 3:9', 'Likkutei Torah, Pinchas 3:14'), ('Zohar, Achrei Mot 50:299', 'Likkutei Torah, Matot 3:6'), ('Zohar, Balak 3:17', 'Likkutei Torah, Masei 2:23'), ('Zohar, Beshalach 32:456', 'Likkutei Torah, Masei 3:26'), ('Zohar, Terumah 51:558', 'Likkutei Torah, Masei 4:3'), ('Zohar, Beshalach 11:134', 'Likkutei Torah, Masei 3:21'), ('Zohar, Beshalach 27:358', 'Likkutei Torah, Masei 3:21'), ('Zohar, Beshalach 11:134', 'Likkutei Torah, Masei 3:21'), ('Zohar, Vayikra 1:5', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 20:119', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 42:288', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 49:338', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 52:356', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 19:116', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 20:119', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 42:288', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 49:338', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 52:356', 'Likkutei Torah, Masei 5:13'), ('Zohar, Vayikra 19:116', 'Likkutei Torah, Masei 5:13'), ('Zohar, Korach 8:38', 'Likkutei Torah, Vaetchanan 6:28'), ('Zohar, Korach 8:39', 'Likkutei Torah, Vaetchanan 6:28'), ('Zohar, Korach 8:40', 'Likkutei Torah, Vaetchanan 6:28'), ('Zohar, Terumah 9:74', 'Likkutei Torah, Vaetchanan 8:15'), ('Zohar, Terumah 46:499', 'Likkutei Torah, Eikev 2:24'), ('Zohar, Terumah 46:499', 'Likkutei Torah, Eikev 2:24'), ('Zohar, Terumah 46:499', 'Likkutei Torah, Eikev 2:24'), ('Zohar, Vayechi 72:751', 'Likkutei Torah, Eikev 2:29'), ('Zohar, Tazria 2:8', 'Likkutei Torah, Eikev 2:25'), ('Zohar, Tazria 2:8', 'Likkutei Torah, Eikev 2:25'), ('Zohar, Tazria 2:8', 'Likkutei Torah, Eikev 2:25'), ('Zohar, Tazria 2:8', 'Likkutei Torah, Eikev 2:25'), ('Zohar, Bo 5:123', "Likkutei Torah, Re'eh 3:10"), ('Zohar, Shmini 6:71', 'Likkutei Torah, Ki Teitzei 7:2'), ('Zohar, Mishpatim 22:524', 'Likkutei Torah, Ki Tavo 1:12'), ('Zohar, Bechukotai 4:18', 'Likkutei Torah, Nitzavim 2:4'), ('Zohar, Bechukotai 1:4', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:56', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:59', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:56', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:57', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:57', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:57', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:57', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:57', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:59', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Bechukotai 15:58', 'Likkutei Torah, Ki Tavo 4:6'), ('Zohar, Achrei Mot 47:288', 'Likkutei Torah, Nitzavim 5:12'), ('Zohar, Yitro 20:331', 'Likkutei Torah, Nitzavim 7:26'), ('Zohar, Yitro 20:338', 'Likkutei Torah, Nitzavim 7:29'), ('Zohar, Tzav 20:140', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Tzav 5:26', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Tzav 2:10', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Tzav 20:140', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Tzav 5:26', 'Likkutei Torah, Rosh Hashanah 4:7'), ('Zohar, Terumah 54:591', 'Likkutei Torah, Rosh Hashanah 6:5'), ('Zohar, Pinchas 124:869', 'Likkutei Torah, Yom Kippur 2:39'), ('Zohar, Bereshit 70:139', 'Likkutei Torah, Yom Kippur 2:55'), ('Zohar, Terumah 29:285', "Likkutei Torah, Ha'Azinu 1:4"), ('Zohar, Terumah 28:282', "Likkutei Torah, Ha'Azinu 1:4"), ('Zohar, Terumah 29:287', "Likkutei Torah, Ha'Azinu 1:4"), ('Zohar, Beshalach 22:313', "Likkutei Torah, Ha'Azinu 1:4"), ('Zohar, Vayakhel 23:288', "Likkutei Torah, Ha'Azinu 1:26"), ('Zohar, Bereshit 8:77', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Bereshit 8:75', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Terumah 94:909', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Beshalach 19:274', 'Likkutei Torah, Sukkot 1:6'), ('Zohar, Noach 1:4', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Noach 18:147', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Noach 39:313', "Likkutei Torah, Ha'Azinu 3:39"), ('Zohar, Balak 6:74', 'Likkutei Torah, Sukkot 2:4'), ('Zohar, Emor 43:271', 'Likkutei Torah, Sukkot 4:7'), ('Zohar, Emor 41:257', 'Likkutei Torah, Shemini Atzeret 5:4'), ('Zohar, Shmini 9:84', 'Likkutei Torah, Shemini Atzeret 5:7'), ('Zohar, Pekudei 14:88', 'Likkutei Torah, Shemini Atzeret 7:9'), ('Zohar, Pekudei 14:88', 'Likkutei Torah, Shemini Atzeret 7:9'), ('Zohar, Pekudei 14:88', 'Likkutei Torah, Shemini Atzeret 7:9'), ('Zohar, Vayechi 75:770', 'Likkutei Torah, Shemini Atzeret 7:15'), ('Zohar, Bereshit 102:432', 'Likkutei Torah, Shemini Atzeret 7:16'), ('Zohar, Bereshit 73:164', 'Likkutei Torah, Shemini Atzeret 7:16'), ('Zohar, Bereshit 23:258', 'Likkutei Torah, Shemini Atzeret 7:16'), ('Zohar, Bereshit 6:59', 'Likkutei Torah, Shemini Atzeret 7:16'), ('Zohar, Bereshit 73:164', 'Likkutei Torah, Shemini Atzeret 7:16'), ('Zohar, Emor 40:253', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 45:289', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 5:16', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 32:154', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 40:253', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 5:16', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Emor 32:154', "Likkutei Torah, V'Zot HaBerachah 2:14"), ('Zohar, Achrei Mot 67:396', 'Likkutei Torah, Shir HaShirim 1:1'), ('Zohar, Achrei Mot 44:259', 'Likkutei Torah, Shir HaShirim 1:2'), ('Zohar, Bereshit 58:29', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 39:397', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 31:325', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 74:173', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 74:174', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 12:137', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 58:29', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 39:397', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 74:173', 'Likkutei Torah, Shir HaShirim 1:3'), ('Zohar, Bereshit 74:174', 'Likkutei Torah, Shir HaShirim 1:3'), ("Zohar, Beha'alotcha 3:13", 'Likkutei Torah, Shir HaShirim 3:10'), ("Zohar, Beha'alotcha 3:13", 'Likkutei Torah, Shir HaShirim 3:10'), ("Zohar, Beha'alotcha 3:13", 'Likkutei Torah, Shir HaShirim 3:10'), ("Zohar, Beha'alotcha 3:13", 'Likkutei Torah, Shir HaShirim 3:10'), ("Zohar, Beha'alotcha 3:13", 'Likkutei Torah, Shir HaShirim 3:10'), ('Zohar, Terumah 9:62', 'Likkutei Torah, Shir HaShirim 5:20'), ('Zohar, Bereshit 7:72', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 95:367', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 75:177', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 69:126', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 58:31', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 35:346', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 98:409', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 75:177', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 69:126', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Bereshit 58:31', 'Likkutei Torah, Shir HaShirim 8:11'), ('Zohar, Shemot 32:273', 'Likkutei Torah, Shir HaShirim 8:24'), ('Zohar, Shemot 50:358', 'Likkutei Torah, Shir HaShirim 8:24'), ('Zohar, Shemot 52:395', 'Likkutei Torah, Shir HaShirim 8:24'), ('Zohar, Kedoshim 14:86', 'Likkutei Torah, Shir HaShirim 8:51'), ('Zohar, Kedoshim 20:131', 'Likkutei Torah, Shir HaShirim 8:51'), ('Zohar, Kedoshim 20:131', 'Likkutei Torah, Shir HaShirim 8:51'), ('Zohar, Kedoshim 14:86', 'Likkutei Torah, Shir HaShirim 8:51'), ('Zohar, Balak 33:354', 'Likkutei Torah, Shir HaShirim 16:11'), ('Zohar, Vayigash 3:26', 'Likkutei Torah, Shir HaShirim 19:38'), ('Zohar, Vayigash 10:104', 'Likkutei Torah, Shir HaShirim 19:38'), ('Zohar, Bo 4:87', 'Likkutei Torah, Shir HaShirim 25:13'), ('Zohar, Bereshit 23:256', 'Likkutei Torah, Shir HaShirim 25:13'), ('Zohar, Balak 6:103', 'Likkutei Torah, Shir HaShirim 29:4'), ('Zohar, Bereshit 9:106', 'Likkutei Torah, Shir HaShirim 31:1'), ('Zohar, Bereshit 9:106', 'Likkutei Torah, Shir HaShirim 31:1'), ('Zohar, Beshalach 18:262', 'Likkutei Torah, Shir HaShirim 29:27'), ('Zohar, Beshalach 27:357', 'Likkutei Torah, Shir HaShirim 29:27'), ('Zohar, Vayeshev 10:102', 'Likkutei Torah, Shir HaShirim 35:3'), ("Zohar, Sh'lach 10:82", 'Torah Ohr, Lech Lecha 4:1'), ('Zohar, Vayigash 4:33', 'Torah Ohr, Miketz 2:2'), ('Zohar, Vayigash 11:108', 'Torah Ohr, Miketz 2:2'), ('Zohar, Vayigash 2:11', 'Torah Ohr, Miketz 2:2'), ('Zohar, Vayigash 5:50', 'Torah Ohr, Miketz 2:2'), ('Zohar, Vayigash 8:72', 'Torah Ohr, Miketz 2:2'), ('Zohar, Vayigash 8:82', 'Torah Ohr, Vayigash 1:11'), ('Zohar, Vayakhel 24:337', 'Torah Ohr, Supplements, Ki Tisa 15'), ('Zohar, Vayakhel 42:486', 'Torah Ohr, Supplements, Ki Tisa 15'), ('Zohar, Vayakhel 42:486', 'Torah Ohr, Supplements, Ki Tisa 15'), ('Zohar, Vayakhel 11:149', 'Torah Ohr, Supplements, Ki Tisa 15'), ('Zohar, Vayakhel 41:472', 'Torah Ohr, Supplements, Ki Tisa 15'), ('Zohar, Vayakhel 6:74', 'Torah Ohr, Supplements, Ki Tisa 15')]
for r1, r2 in pm_pairs:
    try:
        Link({"refs": [r1, r2], "generated_by": "Zohar_Chabad_PM", "auto": True, "type": "Commentary"}).save()
    except Exception as e:
        print(e)
# for r1, r2 in dh_pairs:
#     try:
#         Link({"refs": [r1, r2], "generated_by": "Zohar_Chabad_DH", "auto": True, "type": "Commentary"}).save()
#     except Exception as e:
#         print(e)
